if(typeof AWPageMounts=='undefined'){AWPageMounts={}};AWPageMounts['m003']=[{"name":"001-Mysql Sharding.md","path":"003-æ•°æ®åº“/001-MySQL/001-Mysql Sharding.md","content":"# Sharding\r\n\r\n## æ¦‚å¿µ\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;Sharding,è¯‘ä½œåˆ†ç‰‡ï¼ŒMySQL5ä»¥åæä¾›äº†åˆ†ç‰‡èƒ½åŠ›ï¼Œç›®çš„å°±æ˜¯ä¸ºçªç ´å•ç‚¹æ•°æ®æœåŠ¡å™¨I/Oèƒ½åŠ›é™åˆ¶ï¼Œè§£å†³æ•°æ®åº“Scale Outæ°´å¹³æ‰©å±•çš„é—®é¢˜ã€‚é€šè¿‡Shardingå¯ä»¥å°†æ•°æ®æŒ‰ç…§ç‰©ç†ä½ç½®è´´åˆç”¨æˆ·åˆ†æ­¥ï¼Œå¾—åˆ°æ›´åŠ å¿«é€Ÿçš„å“åº”ï¼›Shardingå°†æ•°æ®åˆ†å—ï¼Œæ›´å°çš„æ•°æ®é›†æ“ä½œæ±‡æ€»èƒ½ç‹—å¾—åˆ°æ›´ä½³çš„ä½“éªŒï¼›åˆ†ç‰‡ä½¿å¾—æ•°æ®åˆ†æ‘Šåœ¨å„ä¸ªæ•°æ®èŠ‚ç‚¹ï¼Œå¯¹å…¶æ“ä½œå®ç°è´Ÿå€ºå‡è¡¡ã€‚\r\n\r\n&nbsp;&nbsp;&nbsp;&nbsp;ShardingæŒ‰æ–¹å‘å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šå‚ç›´åˆ†åŒºå’Œæ°´å¹³åˆ†åŒºï¼ŒæŒ‰æ¨¡å¼å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šé™æ€åˆ†ç‰‡æ¨¡å¼å’ŒåŠ¨æ€åˆ†ç‰‡æ¨¡å¼ã€‚\r\n\r\n### å‚ç›´åˆ†åŒº\r\nä»¥è¡¨ä¸ºå•ä½ï¼ŒæŠŠä¸åŒè¡¨åˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“æˆ–ä¸»æœºä¸Šã€‚ç‰¹ç‚¹æ˜¯è§„åˆ™ç®€å•ï¼Œå®æ–½æ–¹ä¾¿ï¼Œé€‚åˆä¸šåŠ¡ä¹‹é—´è€¦åˆåº¦ä½çš„ç³»ç»Ÿã€‚\r\n### æ°´å¹³åˆ†åŒº\r\nä»¥è¡Œä¸ºå•ä½ï¼Œå°†åŒä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®æŒ‰æŸç§æ¡ä»¶æ‹†åˆ†åˆ°ä¸åŒçš„æ•°æ®åº“æˆ–ä¸»æœºä¸Šã€‚ç‰¹ç‚¹æ˜¯ç›¸å¯¹å¤æ‚ï¼Œé€‚åˆå•è¡¨å·¨å¤§çš„ç³»ç»Ÿã€‚\r\n\r\n### é™æ€åˆ†ç‰‡æ¨¡å¼\r\nåˆ†åŒºé”®æ˜¯é™æ€åˆ†é…çš„ï¼Œä¸€èˆ¬ä½¿ç”¨èŒƒå›´æˆ–å“ˆå¸Œå‡½æ•°ï¼Œä¾‹å¦‚ï¼šæ·±åœ³å›¢é˜Ÿæ”¾åˆ°ä¸€ä¸ªåˆ†ç‰‡ï¼ŒåŒ—äº¬å›¢é˜Ÿæ”¾åˆ°å¦å¤–ä¸€ä¸ªåˆ†ç‰‡ï¼Œæˆ–è€…ç¼–å·ä¸º0096å¼€å¤´çš„å‘˜å·¥æ”¾åˆ°ä¸€ä¸ªåˆ†ç‰‡ï¼Œè€Œ0199å¼€å¤´çš„å‘˜å·¥æ”¾åˆ°å¦å¤–ä¸€ä¸ªåˆ†ç‰‡ã€‚è¿™ç§æ¨¡å¼å®ç°ç®€å•ï¼Œä½†æ˜æ˜¾çš„ç¼ºé™·ä¾¿æ˜¯å­˜åœ¨æ•°æ®ä¸å‡åŒ€çš„æƒ…å†µã€‚\r\n### åŠ¨æ€åˆ†ç‰‡æ¨¡å¼\r\nåˆ†åŒºå‡½æ•°å°†ä»å­—å…¸ä¸­æŸ¥æ‰¾åˆ†åŒºé”®ï¼Œç„¶åå®šä½å…·ä½“å“ªä¸ªåˆ†ç‰‡å­˜å‚¨äº†æ•°æ®ã€‚è¿™ç§æ¨¡å¼æ›´åŠ çµæ´»ï¼Œä½†éœ€è¦ä¸€ä¸ªé›†ä¸­å­˜å‚¨æ¥å­˜æ”¾è´¨ç‚¹ï¼Œæ¯æ¬¡æŸ¥æ‰¾æ•°æ®éƒ½éœ€è¦æ‰§è¡Œä¸¤æ¬¡æŸ¥è¯¢ï¼Œå¹¶ä¸”é›†ä¸­å­˜å‚¨æœ¬èº«è¿˜å¯èƒ½å­˜åœ¨å•ç‚¹æ•…éšœã€‚\r\n\r\n### åˆ†åŒºç±»å‹\r\n1. RANGEåˆ†åŒº\r\n\r\n    åŸºäºå±äºä¸€ä¸ªç»™å®šè¿ç»­åŒºé—´çš„åˆ—å€¼ï¼ŒæŠŠå¤šè¡Œåˆ†é…ç»™åˆ†åŒº\r\n1. LISTåˆ†åŒº\r\n\r\n    ç±»ä¼¼äºæŒ‰RANGEåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºLISTåˆ†åŒºæ˜¯åŸºäºåˆ—å€¼åŒ¹é…ä¸€ä¸ªç¦»æ•£å€¼é›†åˆä¸­çš„æŸä¸ªå€¼æ¥è¿›è¡Œé€‰æ‹©\r\n1. HASHåˆ†åŒº\r\n\r\n    åŸºäºç”¨æˆ·å®šä¹‰çš„è¡¨è¾¾å¼çš„è¿”å›å€¼æ¥è¿›è¡Œé€‰æ‹©çš„åˆ†åŒºï¼Œæ”¹è¡¨è¾¾å¼ä½¿ç”¨å°†è¦æ’å…¥åˆ°è¡¨ä¸­çš„è¿™äº›è¡Œçš„åˆ—å€¼è¿›è¡Œè®¡ç®—\r\n1. KEYåˆ†åŒº\r\n\r\n    ç±»ä¼¼äºæŒ‰HASHåˆ†åŒºï¼ŒåŒºåˆ«åœ¨äºKEYåˆ†åŒºåªæ”¯æŒè®¡ç®—ä¸€åˆ—æˆ–å¤šåˆ—ï¼Œä¸”MySQLæœåŠ¡å™¨æä¾›å…¶è‡ªèº«çš„å“ˆå¸Œå‡½æ•°ï¼Œå¿…é¡»æœ‰ä¸€åˆ—æˆ–å¤šåˆ—åŒ…å«æ•´æ•°å€¼ã€‚\r\n\r\n## ç›¸å…³èµ„æ–™\r\n#### Scale Out\r\n> æ¨ªå‘æ‰©å±•ï¼Œå­—é¢æ„æ€æ¥çœ‹æ˜¯é å¢åŠ å¤„ç†å™¨æ¥æå‡è¿ç®—èƒ½åŠ›å’Œå¢åŠ ç‹¬ç«‹æœåŠ¡å™¨æ¥å¢åŠ è¿ç®—èƒ½åŠ›ã€‚æŒ‡ä¼ä¸šå¯ä»¥æ ¹æ®éœ€æ±‚å¢åŠ ä¸åŒçš„æœåŠ¡å™¨å’Œå­˜å‚¨åº”ç”¨ï¼Œä¾é å¤šéƒ¨æœåŠ¡å™¨ã€å­˜å‚¨ååŒè¿ç®—ï¼Œå€Ÿè´Ÿè½½å‡è¡¡åŠå®¹é”™ç­‰åŠŸèƒ½æ¥æé«˜è¿ç®—èƒ½åŠ›åŠå¯é æ€§\r\n\r\n\r\n#### Scale Up\r\n> çºµå‘æ‰©å±•ï¼ŒæŒ‡ä¼ä¸šåç«¯å¤§å‹æœåŠ¡å™¨ä»¥å¢åŠ å¤„ç†å™¨ç­‰è¿ç®—èµ„æºè¿›è¡Œèƒ½åŠ›å‡çº§ä»¥è·å¾—å¯¹åº”ç”¨æ€§èƒ½çš„è¦æ±‚ï¼Œä½†æ›´å¤§æ›´å¼ºçš„æœåŠ¡å™¨åŒæ—¶ä¹Ÿæ˜¯æ›´æ˜‚è´µçš„ï¼Œå¾€å¾€æˆæœ¬ä¼šå¤§äºéƒ¨ç½²å¤§é‡ç›¸å¯¹ä¾¿å®œçš„æœåŠ¡å™¨æ¥å®ç°æ€§èƒ½çš„æå‡ï¼Œè€Œä¸”æœåŠ¡å™¨æ€§èƒ½æ‰€èƒ½æå‡çš„ç¨‹åº¦ä¹Ÿæœ‰ä¸€å®šçš„ä¸Šé™ã€‚ã€‚\r\n","timestamp":1524798865268},{"name":"001-æ—¶åºæ•°æ®åº“.md","path":"003-æ•°æ®åº“/003-InfluxDB/001-ä»‹ç»/001-æ—¶åºæ•°æ®åº“.md","content":"# æ—¶åºæ•°æ®åº“\r\n\r\n## æ¦‚è¿°\r\n\r\næ—¶åºæ•°æ®åº“ï¼ˆTime Series Database, ç®€ç§°TSDBï¼‰æ˜¯ç”¨äºç®¡ç†æ—¶é—´åºåˆ—æ•°æ®çš„ä¸“ä¸šåŒ–æ•°æ®åº“ï¼Œ åŒºåˆ«ä¸ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ï¼Œ æ—¶åºæ•°æ®åº“é’ˆå¯¹æ—¶é—´åºåˆ—æ•°æ®çš„å­˜å‚¨ã€æŸ¥è¯¢å’Œå±•ç°è¿›è¡Œäº†ä¸“é—¨çš„ä¼˜åŒ–ï¼Œ ä»è€Œè·å¾—æé«˜çš„æ•°æ®å‹ç¼©èƒ½åŠ›ã€æä¼˜çš„æŸ¥è¯¢æ€§èƒ½ï¼Œç‰¹åˆ«é€‚ç”¨äºéœ€è¦å¤„ç†æµ·é‡æ—¶é—´åºåˆ—æ•°æ®çš„åœºæ™¯ã€‚\r\n\r\n### ä»€ä¹ˆæ˜¯æ—¶é—´åºåˆ—æ•°æ®ï¼ˆä»¥ä¸‹ç§°æ—¶åºæ•°æ®ï¼‰\r\næ˜¯æŒ‡åœ¨ä¸åŒæ—¶é—´ç‚¹ä¸Šæ”¶é›†åˆ°çš„æ•°æ®ï¼Œ åæ˜ äº†æŸä¸€äº‹ç‰©ã€ç°è±¡ç­‰éšæ—¶é—´çš„å˜åŒ–çŠ¶æ€æˆ–ç¨‹åº¦ã€‚\r\næ—¶åºæ•°æ®çš„å…¸å‹ç‰¹ç‚¹æ˜¯ï¼šäº§ç”Ÿé¢‘ç‡å¿«ã€ä¸¥é‡ä¾èµ–äºé‡‡é›†æ—¶é—´ï¼ˆæ¯æ¡æ•°æ®å‡è¦æ±‚å¯¹åº”å”¯ä¸€çš„æ—¶é—´ï¼‰ã€æµ‹ç‚¹å¤šä¿¡æ¯é‡å¤§ï¼ˆå¸¸è§„çš„å®æ—¶æ£€æµ‹ç³»ç»Ÿå‡æœ‰æˆåƒä¸Šä¸‡çš„ç›‘æµ‹ç‚¹ã€æ¯ç§’éƒ½åœ¨äº§ç”Ÿæ•°æ®ï¼‰\r\n\r\nåŸºäºæ—¶åºæ•°æ®çš„ç‰¹ç‚¹ï¼Œå…³ç³»å‹æ•°æ®åº“æ— æ³•æ»¡è¶³å¯¹æ—¶åºæ•°æ®çš„æœ‰æ•ˆå­˜å‚¨ä¸å¤„ç†ï¼Œå› æ­¤éœ€è¦ä¸€ç§é’ˆå¯¹æ—¶åºæ•°æ®ä¼˜åŒ–çš„æ•°æ®åº“ï¼Œå³æ—¶åºæ•°æ®åº“ã€‚\r\n\r\n\r\n#### æ—¶åºæ•°æ®ï¼š\r\n![cpu useage](/amWiki/images/tsd/cpu-useage.png)\r\n\r\n#### è§„åˆ™æ—¶åºæ•°æ®ä¸ä¸è§„åˆ™æ—¶åº\r\n![regular vs irregular](/amWiki/images/tsd/regular_irregular.png)\r\n#### éæ—¶åºæ•°æ®ï¼š\r\n![éƒ­é–](/amWiki/images/tsd/rtv.png)\r\n\r\n### æ—¶åºæ•°æ®ä¸¾ä¾‹\r\n1. CPUç›‘æ§æ•°æ®\r\n1. ç¨‹åºå¼‚å¸¸\r\n1. ç”¨æˆ·è®¿é—®é‡\r\n1. ç”¨æˆ·æ“ä½œè®°å½•\r\n1. CDNå¸¦å®½æ•°æ®\r\n1. SVNæäº¤è®°å½•\r\n1. ç­‰ç­‰æ‰€æœ‰ä¸æ—¶é—´ç›¸å…³çš„æ•°æ®\r\n\r\n## å‡ ä¸ªæ—¶åºæ•°æ®åº“ä»‹ç»\r\n\r\n### RRDTool\r\n\r\n| &nbsp; | &nbsp; |\r\n|:--|:--|\r\n|ä¸»é¡µ|(http://oss.oetiker.ch/rrdtool/index.en.html)[http://oss.oetiker.ch/rrdtool/index.en.html]|\r\n|ç¼–å†™è¯­è¨€|Cè¯­è¨€|\r\n|License|GNU GPL V2|\r\n|é¡¹ç›®åˆ›å»ºæ—¶é—´|1999-07-16|\r\n|æ´»è·ƒåº¦|æ´»è·ƒ|\r\n|æ–‡æ¡£|è¯¦ç»†|\r\n\r\nRRDtoolå…¨ç§°ä¸ºRound Robin Database Toolï¼Œä¹Ÿå°±æ˜¯ç”¨äºæ“ä½œRRDçš„å·¥å…·ã€‚\r\n\r\nä»€ä¹ˆæ˜¯RRDå‘¢ï¼Ÿç®€å•æ¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªå¾ªç¯ä½¿ç”¨çš„å›ºå®šå¤§å°çš„æ•°æ®åº“æ–‡ä»¶ï¼ˆå…¶å®ä¹Ÿä¸å¤ªåƒå…¸å‹çš„æ•°æ®åº“ï¼‰ã€‚\r\n\r\nå¤§ä½“æ¥è¯´ï¼ŒRRDtoolæä¾›çš„ä¸»è¦å·¥å…·å¦‚ä¸‹ï¼š\r\n\r\n- åˆ›å»ºRRDï¼ˆrrdtool createï¼‰\r\n- æ›´æ–°RRDï¼ˆrrdtool updateï¼‰\r\n- ç”»å›¾ï¼ˆrrdtool graphï¼‰\r\nè¿™å…¶ä¸­ï¼Œç”»å›¾åŠŸèƒ½æ˜¯æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„ï¼Œç”šè‡³æ”¯æŒä¸‹é¢è¿™äº›å›¾å½¢ï¼Œè¿™æ˜¯å…¶ä»–TSDBä¸­å°‘è§çš„ï¼š\r\n\r\n- æŒ‡æ ‡æ¯”è¾ƒï¼Œå¯¹ä¸¤ä¸ªæŒ‡æ ‡å€¼è¿›è¡Œè®¡ç®—ï¼Œæç”»å‡ºæ»¡è¶³æ¡ä»¶çš„åŒºåŸŸ\r\n- ç§»åŠ¨å¹³å‡çº¿\r\n- å’Œå†å²æ•°æ®è¿›è¡Œå¯¹æ¯”\r\n- åŸºäºæœ€å°äºŒä¹˜æ³•çš„çº¿æ€§é¢„æµ‹\r\n- æ›²çº¿é¢„æµ‹\r\n\r\n2. Graphite\r\n\r\n| &nbsp; | &nbsp; |\r\n|:--|:--|\r\n|ä¸»é¡µ|(http://graphite.readthedocs.org/en/latest/)[http://graphite.readthedocs.org/en/latest/]|\r\n|ç¼–å†™è¯­è¨€|Python|\r\n|License|Apache 2.0|\r\n|é¡¹ç›®åˆ›å»ºæ—¶é—´|2006|\r\n|æ´»è·ƒåº¦|æ´»è·ƒ|\r\n|æ–‡æ¡£|è¯¦ç»†|\r\n\r\nä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼š\r\n\r\n- å­˜å‚¨æ•°å€¼å‹æ—¶åºåˆ—æ•°æ®\r\n- æ ¹æ®è¯·æ±‚å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼ˆç”»å›¾ï¼‰\r\n\r\nç‰¹ç‚¹ï¼š\r\n- åˆ†å¸ƒå¼æ—¶åºåˆ—æ•°æ®å­˜å‚¨ï¼Œå®¹æ˜“æ‰©å±•\r\n- åŠŸèƒ½å¼ºå¤§çš„ç”»å›¾Web APIï¼Œæä¾›äº†å¤§é‡çš„å‡½æ•°å’Œè¾“å‡ºæ–¹å¼\r\n\r\n\r\n3. OpenTSDB\r\n\r\n| - | - |\r\n|:--|:--|\r\n|ä¸»é¡µ|(http://opentsdb.net/)[http://opentsdb.net/]|\r\n|ç¼–å†™è¯­è¨€|Java|\r\n|License|LGPLv2.1+ GPLv3+|\r\n|é¡¹ç›®åˆ›å»ºæ—¶é—´|2010|\r\n|æ´»è·ƒåº¦|æ´»è·ƒ|\r\n|æ–‡æ¡£|è¯¦ç»†|\r\n\r\nOpenTSDBæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€å¯ä¼¸ç¼©çš„æ—¶é—´åºåˆ—æ•°æ®åº“ã€‚å®ƒæ”¯æŒè±ªç§’çº§æ•°æ®é‡‡é›†æ‰€æœ‰metricsï¼Œæ”¯æŒæ°¸ä¹…å­˜å‚¨ï¼ˆä¸éœ€è¦downsamplingï¼‰ï¼Œå’ŒInfluxDBç±»ä¼¼ï¼Œå®ƒä¹Ÿæ˜¯æ— æ¨¡å¼ï¼Œä»¥tagæ¥å®ç°ç»´åº¦çš„æ¦‚å¿µã€‚\r\n\r\nOpenTSDBçš„èŠ‚ç‚¹ç§°ä¸ºTSDï¼ˆTime Series Daemon (TSD)ï¼‰ï¼Œå®ƒæ²¡æœ‰ä¸»ã€ä»ä¹‹åˆ†ï¼Œæ¶ˆé™¤äº†å•ç‚¹éšæ‚£ï¼Œéå¸¸å®¹æ˜“æ‰©å±•ã€‚å®ƒä¸»è¦ä»¥HBaseä½œä¸ºå­˜å‚¨ç³»ç»Ÿï¼Œç°åœ¨ä¹Ÿå¢åŠ äº†å¯¹Cassandraå’ŒBigtableï¼ˆéäº‘ç«¯ï¼‰ã€‚\r\n\r\nOpenTSDBä»¥æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ä¸ºä¸»ï¼Œé™„å¸¦äº†ä¸€ä¸ªç®€å•åœ°å›¾å½¢ç•Œé¢ï¼ˆä¾èµ–Gnuplotï¼‰ï¼Œå…±å¼€å‘ã€è°ƒè¯•ä½¿ç”¨ã€‚\r\n\r\n4. InfluxDB\r\n\r\n|-|-|\r\n|:--|:--|\r\n|ä¸»é¡µ|\thttps://influxdata.com/\r\n|ç¼–å†™è¯­è¨€|Golang|\r\n|License|MIT|\r\n|é¡¹ç›®åˆ›å»ºæ—¶é—´|2013|\r\n|æ´»è·ƒåº¦|æ´»è·ƒ|\r\n|æ–‡æ¡£|è¯¦ç»†|\r\n\r\n\r\nInfluxDBç”±Golangè¯­è¨€ç¼–å†™ï¼Œä¹Ÿæ˜¯ç”±Golangç¼–å†™çš„è½¯ä»¶ä¸­æ¯”è¾ƒè‘—åçš„ä¸€ä¸ªï¼Œåœ¨å¾ˆå¤šGolangçš„æ²™é¾™æˆ–è€…æ–‡ç« ä¸­å¯èƒ½éƒ½ä¼šæŠŠInfluxDBå½“æ ‡æ†æ¥ä»‹ç»ï¼Œè¿™ä¹Ÿé—´æ¥å¸®åŠ©InfluxDBæé«˜äº†çŸ¥ååº¦ã€‚\r\n\r\nInfluxDBçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼š\r\n\r\n- schemaless(æ— ç»“æ„)ï¼Œå¯ä»¥æ˜¯ä»»æ„æ•°é‡çš„åˆ—\r\n- å¯æ‰©å±•ï¼ˆé›†ç¾¤ï¼‰\r\n- æ–¹ä¾¿ã€å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€\r\n- Native HTTP API\r\n- é›†æˆäº†æ•°æ®é‡‡é›†ã€å­˜å‚¨ã€å¯è§†åŒ–åŠŸèƒ½\r\n- å®æ—¶æ•°æ®Downsampling\r\n- é«˜æ•ˆå­˜å‚¨ï¼Œä½¿ç”¨é«˜å‹ç¼©æ¯”ç®—æ³•ï¼Œæ”¯æŒretention polices\r\n- InfluxDBæ˜¯TSDBä¸­ä¸ºæ•°ä¸å¤šçš„è¿›è¡Œäº†ç”¨æˆ·å’Œè§’è‰²æ–¹é¢å®ç°çš„ï¼Œæä¾›äº†Cluster Adminã€Database Adminå’ŒDatabase Userä¸‰ç§è§’è‰²ã€‚\r\n\r\nInfluxDBçš„æ•°æ®é‡‡é›†ç³»ç»Ÿä¹Ÿæ”¯æŒå¤šç§åè®®å’Œæ’ä»¶ï¼š\r\n\r\n- è¡Œæ–‡æœ¬\r\n- UDP\r\n- Graphite\r\n- CollectD\r\n- OpenTSDB\r\n\r\nä¸è¿‡InfluxDBæ¯æ¬¡å˜åŠ¨éƒ½è¾ƒå¤§ï¼Œå°¤å…¶æ˜¯åœ¨å­˜å‚¨å’Œé›†ç¾¤æ–¹é¢ï¼Œè¿½æ±‚å¹³å¹³å®‰è¿‡æ—¥å­ï¼Œä¸æƒ³çæŠ˜è…¾çš„å¯ä»¥è€ƒè™‘ä¸‹ã€‚\r\n\r\n\r\n\r\n> [æœ€æ–°æ—¶åºæ•°æ®åº“æ’è¡Œæ¦œ](https://db-engines.com/en/ranking/time+series+dbms)\r\n","timestamp":1524798865268},{"name":"002-å®‰è£….md","path":"003-æ•°æ®åº“/003-InfluxDB/001-ä»‹ç»/002-å®‰è£….md","content":"\r\n## å®‰è£…\r\n\r\n### CentOS\r\nä½¿ç”¨`yum`å®‰è£…ï¼š\r\n1. æ·»åŠ ä»“åº“åœ°å€\r\n\r\n    ```shell\r\n    cat <<EOF | sudo tee /etc/yum.repos.d/influxdb.repo\r\n    [influxdb]\r\n    name = InfluxDB Repository - RHEL \\$releasever\r\n    baseurl = https://repos.influxdata.com/rhel/\\$releasever/\\$basearch/stable\r\n    enabled = 1\r\n    gpgcheck = 1\r\n    gpgkey = https://repos.influxdata.com/influxdb.key\r\n    EOF\r\n    ```\r\n\r\n1. å®‰è£…\r\n    ```shell\r\n    sudo yum install influxdb\r\n    ```\r\n1. å¯åŠ¨\r\n    ```shell\r\n    sudo service influxdb start\r\n    ```\r\n    `CentOS7+`ç‰ˆæœ¬ç³»ç»Ÿ\r\n    ```\r\n    sudo systemctrl start influxdb\r\n    ```\r\n### é»˜è®¤ç«¯å£ä½œç”¨\r\n\r\n- `8083` webç®¡ç†ç•Œé¢\r\n- `8086` HTTP APIæ¥å£\r\n- `8088` æä¾›ç»™RPCæœåŠ¡åšå¤‡ä»½è¿˜åŸ\r\ninfluxdb.confæ–‡ä»¶ä¸­å¯ä»¥ä¿®æ”¹é»˜è®¤ç«¯å£\r\n\r\n## ä½¿ç”¨\r\nåœ¨å‘½ä»¤è¡Œè¾“å…¥influxå°±å¯ä»¥å¼€å§‹ç®¡ç†æ•°æ®åº“äº†\r\n\r\n### æŸ¥çœ‹æ•°æ®åº“\r\n```shell\r\nD:\\work\\software\\influxdb-1.2.2-1>influx\r\nConnected to http://localhost:8086 version 1.2.2\r\nInfluxDB shell version: 1.2.2\r\n> show databases\r\nname: databases\r\nname\r\n----\r\n_internal\r\nkpy_cdn\r\n\r\n>\r\n```\r\n### åˆ›å»ºæ•°æ®åº“\r\n```shell\r\n> create database my_database\r\n>\r\n```\r\n### ä½¿ç”¨æ•°æ®åº“\r\n```shell\r\n> use my_database\r\nUsing database my_database\r\n>\r\n```\r\n### é€€å‡º\r\n```shell\r\n> exit\r\nD:\\work\\software\\influxdb-1.2.2-1>\r\n```\r\n","timestamp":1524798865268},{"name":"003-æ¦‚å¿µè§£é‡Š.md","path":"003-æ•°æ®åº“/003-InfluxDB/001-ä»‹ç»/003-æ¦‚å¿µè§£é‡Š.md","content":"# InfluxDB æ ¸å¿ƒæ¦‚å¿µ\r\n\r\n## åœºæ™¯å®šä¹‰\r\nåœ¨æ•°æ®åº“`my_database`ä¸­æœ‰ä¸€å¼ è¡¨è®°å½•äº†ä¸¤ä½ç§‘å­¦å®¶ï¼ˆlangstroth å’Œ perpetuaï¼‰åœ¨ä¸¤ä¸ªåœ°ç‚¹ï¼ˆ1 å’Œ 2ï¼‰\r\né‡‡é›†åˆ°çš„è´è¶å’Œèœœèœ‚æ•°é‡çš„æ•°æ®ï¼ˆ2015-08-19T00:00:00Zåˆ°2015-08-19T06:12:00Zï¼‰ï¼š\r\n\r\n```\r\nname: census\r\n-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\r\ntime                      butterflies           honeybees           location            scientist\r\n2015-08-18T00:00:00Z      12                    23                    1                 langstroth\r\n2015-08-18T00:00:00Z      1                     30                    1                 perpetua\r\n2015-08-18T00:06:00Z      11                    28                    1                 langstroth\r\n2015-08-18T00:06:00Z      3                     28                    1                 perpetua\r\n2015-08-18T05:54:00Z      2                     11                    2                 langstroth\r\n2015-08-18T06:00:00Z      1                     10                    2                 langstroth\r\n2015-08-18T06:06:00Z      8                     23                    2                 perpetua\r\n2015-08-18T06:12:00Z      7                     22                    2                 perpetua\r\n```\r\n### è¯´æ˜\r\nç¬¬ä¸€åˆ—timeè®°å½•å­˜å‚¨æ—¶é—´æˆ³ä¿¡æ¯ï¼Œä¸Šé¢çœ‹åˆ°çš„æ—¶é—´æ˜¯ä»¥Internetæ ‡å‡†æ—¶é—´[RFC3339](https://www.ietf.org/rfc/rfc3339.txt)æ ¼å¼æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œ0æ—¶åŒºã€‚\r\n\r\ntimeåé¢çš„ä¸¤åˆ—`butterflies`å’Œ`honeybees`, å«`field`ï¼Œæ˜¯å„ç§è®°å½•å€¼ï¼Œæ²¡æœ‰ç´¢å¼•ï¼Œè¿™é‡Œè¡¨ç¤ºè´è¶å’Œèœœèœ‚çš„æ•°é‡\r\n\r\næœ€åä¸¤åˆ—`location`å’Œ`scientist`ä¸¤ä¸ªå«`tag`ï¼Œæœ‰ç´¢å¼•ï¼Œ åˆ†åˆ«è®°å½•äº†åœ°åŒºå’Œç§‘å­¦å®¶åç§°ï¼Œ tagé€šå¸¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶æ¥æŸ¥è¯¢ä¿¡æ¯ã€‚\r\n\r\n### è§£é‡Šï¼š\r\n- measurement, ç›¸å½“äºå…³ç³»æ•°æ®åº“ä¸­çš„table, æ˜¯tag, field, timeçš„å®¹å™¨ï¼Œä¸Šé¢è¿™å¼ è¡¨çš„åç§°å°±å«åš census, measurementä¸éœ€è¦äº‹å…ˆå®šä¹‰å¥½ç»“æ„ï¼Œmeasurement, tagså’Œfieldséƒ½å¯ä»¥éšæ„æ·»åŠ \r\n\r\n- timestamp: è¡¨çš„ç¬¬ä¸€åˆ—å­—æ®µtime,\r\n- field key: butterflies,honeybees\r\n- field value: 12,         23\r\n- tag key : location, scientist\r\n- tag value: 1,        langstroth\r\n- series: ä¸Šé¢è¿™å¼ è¡¨å°±æœ‰è¿™å››ä¸ªseries\r\n\r\n    |Arbitrary series number| Retention policy| measurement| tag set|\r\n    |:--|:--|:--|:--|\r\n    |series 1| autogen | census| location = 1, scientist = langstroth|\r\n    |series 2| autogen | census| location = 2, scientist = langstroth|\r\n    |series 3| autogen | census| location = 1, scientist = perpetua|\r\n    |series 4| autogen | census| location = 2, scientist = perpetua|\r\n ä¸€ä¸ªserieså…¶å®å°±æ˜¯ retention policy, measurement, tagsetå…±åŒç»„æˆå”¯ä¸€æ ‡è¯†çš„ä¸€æ®µæ—¶é—´åºåˆ—æ•°æ®ï¼Œä¹Ÿå°±æ˜¯åœ¨å›¾æ ‡ä¸Šçš„ä¸€æ¡çº¿\r\n- point: æŸä¸ªseriesçš„åŒä¸€ä¸ªæ—¶åˆ»çš„å¤šä¸ªfieldçš„valueç»„æˆäº†ä¸€ä¸ªpoint,ä¹Ÿå°±æ˜¯çº¿ä¸Šçš„ä¸€ä¸ªç‚¹\r\n\r\n### æ•°æ®ç±»å‹\r\n\r\nfieldå€¼å¯ä»¥å­˜å‚¨ä¸º`string`ã€`float64`ã€`int64`æˆ–`boolean`,æ‰€æœ‰éšåçš„fieldå€¼çš„ç±»å‹å¿…é¡»ä¸ç¬¬ä¸€ä¸ªç‚¹çš„æ•°æ®ä¸€è‡´ã€‚\r\n\r\n- `string`\r\n    é•¿åº¦é™åˆ¶ä¸º64KBï¼Œæ”¯æŒæ‰€æœ‰Unicodeå­—ç¬¦ã€‚\r\n\r\n- `float64`\r\n    float64æ˜¯é»˜è®¤çš„æ•°å­—ç±»å‹ã€‚æ¯”å¦‚`8`æ˜¯ä¸€ä¸ªæµ®ç‚¹å‹ï¼Œ`8i`æ˜¯æ•´æ•°\r\n- `int64`\r\n    æ•´æ•°çš„æœ«å°¾å¿…é¡»åŠ `i`æ¥æ ‡è¯†ï¼Œæ¯”å¦‚`bikes_present=15i`å­˜å‚¨æ•´æ•°è€Œ`bike_present=15`å­˜å‚¨æµ®ç‚¹ã€‚\r\n- `boolean`\r\n    trueçš„å­—é¢é‡å¯ä»¥å†™ä¸º`t`,`T`,`true`,`True`æˆ–è€…`TRUE`ï¼›\r\n    falseå­—é¢é‡å¯ä»¥è°¢ä¼Ÿ`f`,`F`,`false`,`False`æˆ–è€…`FALSE`ã€‚\r\n\r\n### ç‰¹æ®Šå­—ç¬¦\r\nä»¥ä¸‹å‡ ä¸ªå­—ç¬¦ä¸²åœ¨tag key, tag value, field keyè¿™äº›åœºæ™¯ä¸‹ä½¿ç”¨æ—¶æ˜¯è¦åæ–œæ `\\`æ¥è½¬ä¹‰ï¼š\r\n- é€—å· `,`\r\n- ç­‰å· `=`\r\n- ç©ºæ ¼ ` `\r\n\r\nmeasurementåå­—ä¸­éœ€è¦åæ–œæ è½¬ä¹‰çš„å­—ç¬¦ï¼š\r\n- é€—å· `,`\r\n- ç©ºæ ¼ ` `\r\n\r\nfield valueéœ€è¦è½¬ä¹‰çš„å­—ç¬¦ï¼š\r\n- åŒå¼•å· `\"`\r\n\r\nç¤ºä¾‹\r\n```sql\r\nINSERT \"measurement\\ with\\ quoâš¡ï¸es\\ and\\ emoji\",tag\\ key\\ with\\ spğŸš€ces=tag\\,value\\,with\"commas\" field_k\\ey=\"string field value, only \\\" need be escğŸ­ped\"\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","timestamp":1524798865268},{"name":"001-CURD.md","path":"003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/001-CURD.md","content":"# CURD\r\n\r\n## æ’å…¥\r\n\r\nè¯­æ³•\r\n```sql\r\ninsert <measurement name>[,tag_key1=tag_value1,...] field_key=field_value[,field_key2=field_value2,...] [timestamp]\r\n```\r\n\r\n### ç¤ºä¾‹\r\n1.\r\n```sql\r\ninsert census,location=1,scientist=langstroth butterflies=12,honeybees=23 1234567890000000000\r\n```\r\n1. æ­£ç¡®çš„å†™æ³•\r\n```sql\r\ninsert measurement field_value=12\r\ninsert measurement field_value=12 1439587925\r\ninsert measurement,tag_key=tag_value field_value=12\r\ninsert measurement,tag_key=tag_value field_value=12 1439587925\r\ninsert measurement,tag_key=tag_value field_value=12,other_field=14 1439587925\r\n```\r\n1. é”™è¯¯å†™æ³•\r\n```sql\r\ninsert measurement,value=12\r\ninsert measurement value=12,1439587925\r\ninsert measurement foo=bar value=12\r\ninsert measurement,foo=bar,value=12 1439587925\r\ninsert measurement,foo=bar\r\ninsert measurement,foo=bar 1439587925\r\n```\r\n\r\næ—¶é—´æˆ³ä¸ä¼ æ—¶é»˜è®¤ä¸ºå½“å‰æœåŠ¡å™¨æœ¬åœ°æ—¶é—´ï¼Œå•ä½ä¸ºçº³ç§’.\r\n\r\n## æŸ¥è¯¢\r\n\r\n### åŸºæœ¬è¯­æ³•:\r\n1. `select *`\r\n    æŸ¥è¯¢è¿”å›æ‰€æœ‰fieldå’Œtagçš„å†…å®¹\r\n1. `selecy \"<field_key>\"`\r\n    æŸ¥è¯¢è¿”å›æŒ‡å®šçš„fieldå†…å®¹\r\n1. `select \"<field_key>\",\"<field_key>\"`\r\n    æŸ¥è¯¢è¿”å›å¤šä¸ªfieldå†…å®¹\r\n1. `select \"<field_key>\",\"<tag_key>\"`\r\n    æŸ¥è¯¢è¿”å›æŒ‡å®šçš„fieldå’Œtagå†…å®¹\r\n1. `select \"<field_key>\"::field,\"<tag_key>\"::tag`\r\n    æŸ¥è¯¢è¿”å›æŒ‡å®šçš„field,tagå†…å®¹ï¼Œ`::field`,`::tag`è¯­æ³•æ˜¯åœ¨field, tagé‡åçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œ\r\n\r\n### åœ¨æŸ¥è¯¢è¯­å¥ä¸­ä½¿ç”¨æ•°å­¦è¿ç®—\r\nè¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œæ ‡å‡†çš„æ•°å­¦è¿ç®—ç¬¦ä¼˜å…ˆçº§ä¸€è‡´ï¼Œæ‹¬å·æ‹¥æœ‰æœ€é«˜ä¼˜å…ˆçº§ã€‚\r\n#### åŠ æ³•è¿ç®—\r\n1. æŸ¥è¯¢å­—æ®µA+5çš„å’Œ\r\n    ```sql\r\n    select \"A\" + 5 from \"add\"\r\n    ```\r\n1. ç›¸å½“äºæŸ¥è¯¢ A > 5çš„è¡Œ\r\n    ```sql\r\n    select * from \"add\" WHERE \"A\" + 5 > 10\r\n    ```\r\n1. æŸ¥è¯¢ Aåˆ—å’ŒBåˆ—çš„å’Œ\r\n    ```sql\r\n    select \"A\" + \"B\" from \"add\"\r\n    ```\r\n\r\n1. æŸ¥è¯¢Aåˆ—å’ŒBåˆ—å’Œå¤§äºç­‰äº10çš„è¡Œ\r\n    ```sql\r\n    select * from \"add\" where \"A\"+\"B\" >= 10\r\n    ```\r\n#### å‡æ³•è¿ç®—\r\n1.\r\n    ```sql\r\n    select 1-\"A\" from \"sub\"\r\n    ```\r\n1.\r\n    ```sql\r\n    select * from \"sub\" where 1-\"A\" <= 3\r\n    ```\r\n1.\r\n    ```sql\r\n    select \"A\" - \"B\" from \"sub\"\r\n    ```\r\n1.\r\n    ```sql\r\n    select * from \"sub\" where \"A\" - B <= 1\r\n    ```\r\n#### ä¹˜æ³•å’Œé™¤æ³•ä¸ä¸Šé¢ç”¨æ³•ç›¸åŒ\r\n#### æ··åˆè¿ç®—\r\n\r\n```sql\r\nselect 10 / (\"A\" + \"B\" + \"C\") from \"mult\"\r\n```\r\n\r\n#### ä¸å‡½æ•°æ··åˆè¿ç®—\r\n> åªèƒ½åœ¨selectå­å¥ä¸­ä½¿ç”¨\r\n\r\n```sql\r\nselect 10 * mean(â€œvalueâ€) from â€cpuâ€œ\r\n```\r\né”™è¯¯çš„å†™æ³•, ä¼šæŠ¥è¯­æ³•é”™è¯¯\r\n```sql\r\nselect mean(10 * â€œvalueâ€) from â€cpuâ€œ\r\n```\r\n\r\nä¸æ”¯æŒçš„è¿ç®—ç¬¦\r\n\r\n- æ¯”è¾ƒè¿ç®—ç¬¦\r\n    `=`,`!=`,`<`,`>`,`<=`,`>=`,`<>`\r\n- é€»è¾‘è¿ç®—ç¬¦\r\n    `&`,`|`,`!|`,`NAND`,`XOR`,`NOR`\r\n- å…¶å®ƒ\r\n    `%`, `^`\r\n\r\n### å‡½æ•°\r\n\r\n- èšåˆå‡½æ•°\r\n    - count()\r\n    - distinct()\r\n    - integral() Ã—\r\n    - mean() å¹³å‡å€¼\r\n    - median() ä¸­å€¼\r\n    - mode() è¿”å›å‡ºç°é¢‘ç‡æœ€é«˜çš„å€¼\r\n    - spread() æœ€å¤§å€¼ä¸æœ€å°å€¼çš„å·®\r\n    - stddev() æ ‡å‡†å·®\r\n    - sum()\r\n- é€‰æ‹©å‡½æ•°\r\n    - bottom() è¿”å›æœ€å°çš„Nä¸ªå€¼\r\n    - first() è¿”å›æ—¶é—´æˆ³æœ€å°ï¼ˆæœ€è€ï¼‰çš„ä¸€ä¸ªfieldå€¼\r\n    - last() è¿”å›æ—¶é—´æˆ³æœ€å¤§ï¼ˆæœ€æ–°ï¼‰çš„ä¸€ä¸ªfieldå€¼\r\n    - max() æœ€å¤§å€¼\r\n    - min() æœ€å°å€¼\r\n    - percentile()\r\n    - sample() éšæœºé€‰Nä¸ªfieldå€¼è¿”å›\r\n    - top() è¿”å›æœ€å¤§çš„Nä¸ªå€¼\r\n- è½¬æ¢å‡½æ•°\r\n    - ceiling()\r\n    - cumulative_sum()\r\n    - derivative()\r\n    - difference()\r\n    - elapsed()\r\n    - floor()\r\n    - histogram()\r\n    - moving_average()\r\n    - non_negtive_derivative()\r\n- é¢„æµ‹å‡½æ•°\r\n    - holt_winters()\r\n\r\nç”¨æ³•è§[å®˜æ–¹æ–‡æ¡£](https://docs.influxdata.com/influxdb/v1.2/query_language/functions/)\r\n\r\n### æ•°æ®ç±»å‹è½¬æ¢\r\nè¯­æ³•ï¼š\r\n```sql\r\nSELECT_clause <field_key>::<type> FROM_clause\r\n```\r\næ”¯æŒçš„ç±»å‹ï¼šfloat, integer, string, boolean\r\n\r\n### æ­£åˆ™è¡¨è¾¾å¼\r\næ”¯æŒè¯¥è¯­æ³•çš„ä½ç½®ï¼š\r\n- selectå­å¥ä¸­çš„field keyså’Œtag keys\r\n    ```sql\r\n    select /^bandwidth.*/ from \"bandwidth-data\"\r\n    ```\r\n- è¡¨åç§°\r\n    ```sql\r\n    select * from /bandwidth\\-data\\-\\d+/\r\n    ```\r\n- whereå­å¥ä¸­çš„ tagå€¼ä»¥åŠå­—ç¬¦ä¸²ç±»å‹çš„fieldå€¼\r\n    æŸ¥è¯¢åŒ¹é…é¡¹\r\n    ```sql\r\n    select * from \"bandwidth-data\" where stag =~ /\\w+/\r\n    ```\r\n    æŸ¥è¯¢ä¸åŒ¹é…é¡¹\r\n    ```sql\r\n    select * from \"bandwidth-data\" where stag !~ /\\w+/\r\n    ```\r\n- group by å­å¥ä¸­çš„ tagå€¼\r\n    ```sql\r\n    select * from \"bandwidth-data\" group by /^tag_.*/\r\n    ```\r\n\r\n## æ›´æ–°\r\nä¸æ”¯æŒç›´æ¥æ›´æ–°ï¼Œå¯ä»¥ä½¿ç”¨insert è¯­å¥è®¾ç½®ç›¸åŒçš„æ—¶é—´æˆ³å’Œtagå€¼æ¥æ›´æ–°field value\r\n\r\n## åˆ é™¤\r\nä¸æ”¯æŒä½¿ç”¨è¯­å¥ç›´æ¥åˆ é™¤æ•°æ®ï¼Œåªèƒ½é€šè¿‡æ•°æ®ä¿ç•™ç­–ç•¥æ¸…ç†æ•°æ®ï¼Œ å‚è€ƒæ–‡æ¡£ï¼ˆ[æ•°æ®ä¿ç•™ç­–ç•¥.md](?file=003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/003-æ•°æ®ä¿ç•™ç­–ç•¥ \"æ•°æ®ä¿ç•™ç­–ç•¥\")ï¼‰ï¼›","timestamp":1524798865268},{"name":"002-æ•°æ®åº“ç®¡ç†.md","path":"003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/002-æ•°æ®åº“ç®¡ç†.md","content":"# æ•°æ®åº“ç®¡ç†\r\n\r\n## æ•°æ®åº“\r\n\r\n### åˆ›å»ºæ•°æ®åº“\r\n\r\n```sql\r\ncreate database \"NOAA_water_database\"\r\n```\r\n\r\nåˆ›å»ºæ•°æ®åº“çš„åŒæ—¶åˆ›å»ºä¸€ä¸ªé»˜è®¤æ•°æ®ä¿ç•™ç­–ç•¥\r\n```sql\r\nCREATE DATABASE \"NOAA_water_database\" WITH DURATION 3d REPLICATION 1 SHARD DURATION 1h NAME \"liquid\"\r\n```\r\n\r\n### åˆ é™¤æ•°æ®åº“\r\n```sql\r\ndrop database \"NOAA_water_database\"\r\n```\r\n\r\n## è¡¨\r\n\r\n### åˆ›å»ºè¡¨\r\næ’å…¥æ•°æ®å³åˆ›å»ºè¡¨\r\n\r\n```sql\r\ninsert census,butterflies=12,honeybees=23 location=1,scientist=langstroth\r\n```\r\n\r\n### åˆ é™¤è¡¨\r\n\r\n```sql\r\ndrop measurement \"census\" on \"NOAA_water_database\"\r\n```\r\n> åˆ é™¤è¡¨ä¸æ”¯æŒæ­£åˆ™\r\n\r\n## åºåˆ—\r\n\r\n### Dropåˆ é™¤\r\nåˆ é™¤æ•°æ®çš„åŒæ—¶åˆ é™¤ç´¢å¼•ï¼Œwhereå­å¥ä¸å¯ä»¥ä½¿ç”¨æ—¶é—´åšæ¡ä»¶\r\n```sql\r\nDROP SERIES FROM <measurement_name[,measurement_name]> WHERE <tag_key>=\'<tag_value>\'\r\n```\r\n### deleteåˆ é™¤\r\nåˆ é™¤æ•°æ®ï¼Œ ä½†ä¸åˆ é™¤ç´¢å¼•ï¼Œ whereå­å¥å¯ä»¥ç”¨æ—¶é—´åšæ¡ä»¶\r\n```sql\r\nDELETE FROM <measurement_name> WHERE [<tag_key>=\'<tag_value>\'] | [<time interval>]\r\n```\r\n","timestamp":1524798865268},{"name":"003-æ•°æ®ä¿ç•™ç­–ç•¥.md","path":"003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/003-æ•°æ®ä¿ç•™ç­–ç•¥.md","content":"# æ•°æ®ä¿ç•™ç­–ç•¥\r\n\r\n## ä»‹ç»\r\nInfluxDBçš„æ•°æ®ä¿ç•™ç­–ç•¥æ˜¯ç”¨æ¥å®šä¹‰æ•°æ®å­˜æ”¾çš„æ—¶é—´ï¼Œæˆ–è€…å®šä¹‰ä¿å­˜æŸä¸ªèµ·è§çš„æ•°æ®ã€‚\r\nä¸€ä¸ªæ•°æ®åº“å¯ä»¥æœ‰å¤šä¸ªä¿ç•™ç­–ç•¥ï¼Œ æ–°ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤ä¿ç•™ç­–ç•¥åä¸º`autogen`,\r\né»˜è®¤ä¿ç•™ç­–ç•¥å¯ä»¥åœ¨åˆ›å»ºæ•°æ®åº“æ—¶æŒ‡å®šï¼Œå‚è§[æ•°æ®åº“ç®¡ç†](?file=003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/002-æ•°æ®åº“ç®¡ç† \"æ•°æ®åº“ç®¡ç†\")æ–‡æ¡£ã€‚\r\n\r\n## æ“ä½œ\r\n\r\n### æŸ¥çœ‹æ•°æ®åº“çš„ç°æœ‰ç­–ç•¥\r\n```shell\r\n> show retention policies on \"database name\"\r\nname    duration shardGroupDuration replicaN default\r\n----    -------- ------------------ -------- -------\r\nautogen 0s       168h0m0s           1        true\r\n```\r\n\r\nå¯ä»¥çœ‹å‡ºè¿™ä¸ªæ•°æ®åº“åªæœ‰ä¸€ä¸ªç­–ç•¥ï¼Œ å„ä¸ªå­—æ®µå«ä¹‰å¦‚ä¸‹ï¼š\r\n- name: åç§°ï¼Œ autogen\r\n- duration æ•°æ®ä¿ç•™æ—¶é—´ï¼Œ 0ä»£è¡¨æ— é™åˆ¶\r\n- shardGroupDuration shardGroupçš„å­˜å‚¨æ—¶é—´èŒƒå›´ï¼ŒshardGroupæ˜¯InfluxDBçš„ä¸€ä¸ªåŸºæœ¬å­˜å‚¨ç»“æ„ï¼Œå¤§äºè¿™ä¸ªæ—¶é—´çš„æ•°æ®åœ¨æŸ¥è¯¢æ•ˆç‡ä¸Šåº”è¯¥æœ‰æ‰€é™ä½\r\n- replicaN replication , å‰¯æœ¬ä¸ªæ•°\r\n- default æ˜¯å¦é»˜è®¤ç­–ç•¥\r\n\r\n\r\n### æ–°å»ºç­–ç•¥\r\n\r\nè¯­æ³•\r\n```sql\r\nCREATE RETENTION POLICY <retention_policy_name> ON <database_name> DURATION <duration> REPLICATION <n> [SHARD DURATION <duration>] [DEFAULT]\r\n```\r\n\r\nè¯­æ³•è§£é‡Šï¼š\r\n\r\n- DURATION\r\n    æŒ‡å®šæ•°æ®ä¿ç•™æ—¶é•¿ï¼Œ æœ€å¤§ä¸º`INF`ï¼Œæœ€å°ä¸º1h, 0sä¹Ÿè¡¨ç¤ºæ— é™\r\n- REPLICATION\r\n    æŒ‡å®šæ¯è¡Œæ•°æ®åœ¨å¤šä¸ªé›†ç¾¤ä¸­å­˜å‚¨å¤šå°‘ä¸ªç‹¬ç«‹å‰¯æœ¬ï¼Œnæ˜¯å‰¯æœ¬æ•°é‡\r\n- SHARD DURATION\r\n    æŒ‡å®šæ¯ä¸ªshardGroupå­˜å‚¨æ—¶é—´èŒƒå›´ï¼Œæœ€å¤§ä¸º`INF`, ä¸å†™çš„æƒ…å†µä¸‹é»˜è®¤ä¸ºDURATIONçš„å€¼\r\n- DEFAULT\r\n    æŒ‡å®šä¸ºé»˜è®¤ç­–ç•¥\r\n\r\n### ä¿®æ”¹ç­–ç•¥\r\n\r\nè¯­æ³•ï¼š\r\n```sql\r\nALTER RETENTION POLICY <retention_policy_name> ON <database_name> DURATION <duration> REPLICATION <n> SHARD DURATION <duration> DEFAULT\r\n```\r\n### åˆ é™¤ç­–ç•¥\r\n```sql\r\nDROP RETENTION POLICY <retention_policy_name> ON <database_name>\r\n```\r\n","timestamp":1524798865268},{"name":"004-è¿ç»­æŸ¥è¯¢.md","path":"003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/004-è¿ç»­æŸ¥è¯¢.md","content":"# è¿ç»­æŸ¥è¯¢\r\n\r\n\r\n## ä»‹ç»\r\n<!-- è¿ç»­æŸ¥è¯¢æ˜¯ä¸€ç§èƒ½åœ¨æ•°æ®æ›´æ–°æ—¶è‡ªåŠ¨è¿è¡Œå¹¶å°†æŸ¥è¯¢ç»“æœæ’å…¥åˆ°æŒ‡å®šçš„è¡¨ä¸­çš„InfluxQLæŸ¥è¯¢è¯­å¥ï¼Œ -->\r\nInfluxDBçš„è¿ç»­æŸ¥è¯¢æ˜¯åœ¨æ•°æ®åº“ä¸­è‡ªåŠ¨å®šæ—¶å¯åŠ¨çš„ä¸€ç»„è¯­å¥ï¼Œè¯­å¥ä¸­å¿…é¡»åŒ…å«select, group by time() å…³é”®è¯ï¼Œ\r\nå…¶ä¸»è¦ç”¨äºæ•°æ®å½’æ¡£ï¼Œä»¥é™ä½ç²¾åº¦ä¸ºä»£ä»·é™ä½ç³»ç»Ÿç©ºé—´çš„å ç”¨ç‡ã€‚\r\nä½¿ç”¨è¿ç»­æŸ¥è¯¢æ˜¯æœ€ä¼˜çš„é™ä½é‡‡æ ·ç‡çš„æ–¹å¼ï¼Œè¿ç»­æŸ¥è¯¢å’Œå­˜å‚¨ç­–ç•¥æ­é…ä½¿ç”¨å°†ä¼šå¤§å¤§é™ä½InfluxDBçš„ç³»ç»Ÿå ç”¨é‡ã€‚\r\nè€Œä¸”ä½¿ç”¨è¿ç»­æŸ¥è¯¢åï¼Œæ•°æ®ä¼šå­˜æ”¾åˆ°æŒ‡å®šçš„æ•°æ®è¡¨ä¸­ï¼Œè¿™æ ·å°±ä¸ºä»¥åç»Ÿè®¡ä¸åŒç²¾åº¦çš„æ•°æ®æä¾›äº†æ–¹ä¾¿ã€‚\r\n\r\n### è¿è¡Œæ—¶æœº\r\n<!--\r\nCQs operate on realtime data. They use the local serverâ€™s timestamp, the GROUP BY time() interval, and InfluxDBâ€™s preset time boundaries to determine when to execute and what time range to cover in the query. -->\r\n\r\nè¿ç»­æŸ¥è¯¢å¯¹å®æ—¶æ•°æ®è¿›è¡Œæ“ä½œã€‚å®ƒä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨çš„æ—¶é—´æˆ³ï¼Œgroup by time()å­å¥çš„äº‹ä»¶é—´éš” ä»¥åŠInfluxBDé¢„è®¾çš„æ—¶é—´è¾¹ç•Œæ¥å†³å®šä½•æ—¶æ‰§è¡Œä»¥åŠåœ¨æŸ¥è¯¢ä¸­è¦†ç›–çš„æ—¶é—´èŒƒå›´ã€‚\r\nåœ¨è¿ç»­æŸ¥è¯¢çš„whereå­å¥ä¸­ä½¿ç”¨æ—¶é—´æ¡ä»¶ä¼šè¢«ç›´æ¥å¿½ç•¥æ‰ã€‚\r\n\r\n## è¯­æ³•\r\n\r\n### æ–°å»ºè¿ç»­æŸ¥è¯¢\r\n\r\n```sql\r\nCREATE CONTINUOUS QUERY <cq_name> ON <database_name>\r\nBEGIN\r\n  <cq_query>\r\nEND\r\n```\r\n\r\n#### æŸ¥è¯¢éƒ¨åˆ†ï¼š cq_query\r\ncq_queryç”±å‡½æ•°ã€intoå­å¥ä»¥åŠGroup by å­å¥ç»„åˆï¼Œ ç»“æ„å¦‚ä¸‹ï¼š\r\n```sql\r\nSELECT <function[s]> INTO <destination_measurement> FROM <measurement> [WHERE <stuff>] GROUP BY time(<interval>)[,<tag_key[s]>]\r\n```\r\n\r\n#### ä½¿ç”¨ç¤ºä¾‹\r\nç»Ÿè®¡æ¯ä¸ªåŸŸåæ¯å°æ—¶çš„æµé‡æ€»å’Œï¼Œ å¹¶å°†ç»“æœå­˜å…¥cdn_monitor_flow_1hè¡¨ä¸­\r\n```sql\r\nselect sum(EDGE_FLOW) AS EDGE_FLOW into cdn_monitor_flow_1h from cdn_monitor_slave group by time(1h),* fill(-1)\r\n```\r\n","timestamp":1524798865268},{"name":"005-ç”¨æˆ·ç®¡ç†.md","path":"003-æ•°æ®åº“/003-InfluxDB/002-åŸºæœ¬æ“ä½œ/005-ç”¨æˆ·ç®¡ç†.md","content":"# InfluxDB ç”¨æˆ·ç®¡ç†\r\n\r\n## ç®¡ç†å‘˜ç”¨æˆ·ç®¡ç†\r\n\r\n### å¼€å¯æƒé™\r\ninfluxdb.confæ–‡ä»¶\r\n```config\r\n[http]\r\n  # Determines whether HTTP endpoint is enabled.\r\n  # enabled = true\r\n\r\n  # The bind address used by the HTTP service.\r\n  # bind-address = \":8086\"\r\n\r\n  # Determines whether HTTP authentication is enabled.\r\n  auth-enabled = true\r\n\r\n  # The default realm sent back when issuing a basic auth challenge.\r\n  # realm = \"InfluxDB\"\r\n\r\n  # Determines whether HTTP request logging is enable.d\r\n  # log-enabled = true\r\n\r\n  # Determines whether detailed write logging is enabled.\r\n  # write-tracing = false\r\n```\r\nauth-enabledé…ç½®æˆtrue\r\n\r\n### åˆ›å»ºç®¡ç†å‘˜è´¦å·\r\n```sql\r\ncreate user <username> with password <password> with all privileges;\r\n```\r\n\r\n### æˆæƒ\r\n```sql\r\ngrant all privileges to <username>\r\n```\r\n\r\n### æ’¤æƒ\r\n```sql\r\nrevoke all privileges from <username>\r\n```\r\n### æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·\r\n```sql\r\nshow users;\r\n```\r\n## éç®¡ç†å‘˜ç”¨æˆ·ç®¡ç†ï¼š\r\n\r\n### åˆ›å»º\r\n```sql\r\ncreate user <username> with password \'<password>\'\r\n```\r\n\r\n### æˆæƒ\r\n\r\næˆäºˆè¯»ã€å†™æˆ–æ‰€æœ‰æ•°æ®åº“æƒé™\r\n```sql\r\ngrant [read, write, all] on ,database_name. to <username>\r\n```\r\n### æ’¤æƒ\r\n```sql\r\nrevoke [read, write, all] on <database_name> from <username>\r\n```\r\n\r\n### æŸ¥çœ‹ç”¨æˆ·æƒé™\r\n```sql\r\nshow grants for <username>\r\n```\r\n\r\n### æ›´æ–°ç”¨æˆ·å¯†ç \r\n```shell\r\nset password for <username> = \'<new_password>\'\r\n```\r\n### åˆ é™¤ç”¨æˆ·\r\n```sql\r\ndrop user <username>\r\n```\r\n\r\n\r\n> éç®¡ç†å‘˜ç”¨æˆ·å®¢æˆ·ç«¯ä¸èƒ½é€šè¿‡use databaseæ¥ä½¿ç”¨æ—¶æ•°æ®åº“","timestamp":1524798865268},{"name":"001-é›†ç¾¤.md","path":"003-æ•°æ®åº“/003-InfluxDB/003-é«˜å¯ç”¨æ€§/001-é›†ç¾¤.md","content":"# é›†ç¾¤\r\n\r\n<!-- InfluxDBä»0.9.3å¼€å§‹æ”¯æŒä»»æ„å¤§å°çš„é›†ç¾¤æ— éœ€å®Œå…¨å¤åˆ¶ï¼Œæ–°çš„æ•°æ®èŠ‚ç‚¹å¯ä»¥åŠ å…¥åˆ°é›†ç¾¤ä¸­ï¼Œ -->","timestamp":1524798865268}]