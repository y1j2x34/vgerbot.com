# Sharding

## 概念

&nbsp;&nbsp;&nbsp;&nbsp;Sharding,译作分片，MySQL5以后提供了分片能力，目的就是为突破单点数据服务器I/O能力限制，解决数据库Scale Out水平扩展的问题。通过Sharding可以将数据按照物理位置贴合用户分步，得到更加快速的响应；Sharding将数据分块，更小的数据集操作汇总能狗得到更佳的体验；分片使得数据分摊在各个数据节点，对其操作实现负债均衡。

&nbsp;&nbsp;&nbsp;&nbsp;Sharding按方向可以分为两类：垂直分区和水平分区，按模式可以分为两大类：静态分片模式和动态分片模式。

### 垂直分区
以表为单位，把不同表分散到不同的数据库或主机上。特点是规则简单，实施方便，适合业务之间耦合度低的系统。
### 水平分区
以行为单位，将同一个表中的数据按某种条件拆分到不同的数据库或主机上。特点是相对复杂，适合单表巨大的系统。

### 静态分片模式
分区键是静态分配的，一般使用范围或哈希函数，例如：深圳团队放到一个分片，北京团队放到另外一个分片，或者编号为0096开头的员工放到一个分片，而0199开头的员工放到另外一个分片。这种模式实现简单，但明显的缺陷便是存在数据不均匀的情况。
### 动态分片模式
分区函数将从字典中查找分区键，然后定位具体哪个分片存储了数据。这种模式更加灵活，但需要一个集中存储来存放质点，每次查找数据都需要执行两次查询，并且集中存储本身还可能存在单点故障。

### 分区类型
1. RANGE分区

    基于属于一个给定连续区间的列值，把多行分配给分区
1. LIST分区

    类似于按RANGE分区，区别在于LIST分区是基于列值匹配一个离散值集合中的某个值来进行选择
1. HASH分区

    基于用户定义的表达式的返回值来进行选择的分区，改表达式使用将要插入到表中的这些行的列值进行计算
1. KEY分区

    类似于按HASH分区，区别在于KEY分区只支持计算一列或多列，且MySQL服务器提供其自身的哈希函数，必须有一列或多列包含整数值。

## 相关资料
#### Scale Out
> 横向扩展，字面意思来看是靠增加处理器来提升运算能力和增加独立服务器来增加运算能力。指企业可以根据需求增加不同的服务器和存储应用，依靠多部服务器、存储协同运算，借负载均衡及容错等功能来提高运算能力及可靠性


#### Scale Up
> 纵向扩展，指企业后端大型服务器以增加处理器等运算资源进行能力升级以获得对应用性能的要求，但更大更强的服务器同时也是更昂贵的，往往成本会大于部署大量相对便宜的服务器来实现性能的提升，而且服务器性能所能提升的程度也有一定的上限。。
