# 什么是微服务

## 定义

### 维基百科定义：

>
> 微服务是由单体应用程序构成的小服务，拥有自己的进程与轻量化处理,
> 服务依业务功能设计，以全自动方式部署，与其它服务使用HTTP API 通讯。
> 同时，服务会使用最小规模的集中管理（Docker），服务可以用不同的编程语言与数据
> 库

### 理解定义

#### 单体应用

以MVC架构为例（Spring + iBatis/Hibernate + Tomcat），一个归档包（例如war包）包含了应用所有功能，部署在一个容器中，监听某个端口就可以对外提供服务。在业务规模不大、开发团队人员规模较小时，采用单体应用架构，团队的开发和运维成本都可控。

业务规模扩大，团队开发人员扩张，单体应用架构就会开始出现问题， 大概有以下几个方面：

1. 部署效率低下
    单体应用代码越来越多、依赖资源越来越多时，应用编译打包、部署测试所需时间也会越来越多
1. 团队协作开发成本高
    测试阶段只要有一块功能有问题，就得重新编译打包部署，然后重新预览测试，所有相关的开发人员都得参与，效率低下，开发成本高
1. 系统高可用性差
    因为所有功能都在一个进程中，只要其中一个功能出问题，就会影响到整体，造成服务不可用。
1. 线上发布变慢
    代码膨胀导致启动时间变长, 机器规模很大时，单次发布就需要更多时间，所以需要一种方法能将应用的**不同模块解耦**，降低开发和部署成本

#### 服务化

通俗的话来讲：就是把单机引用中的通过JAR包依赖产生的本地方法调用，改造成通过RPC（或其它协议）接口产生的远程方法调用。

把不同模块从单体引用中拆分出来，独立成一个服务部署，以RPC接口的形式对外提供服务。这样就可以对不同模块独立出来交给不同的团队来专门负责开发、测试、上线和运维，每个独立模块与主模块不耦合。

服务化可以解决单体应用膨胀、团队开发耦合度高、协作效率底下的问题。

#### 什么是微服务？

微服务与服务化不同点：

- 服务拆分粒度更细：
    微服务可以说是更细粒度的服务化，小到一个子模块，只要该模块依赖的资源与其它模块都没有关系，就可以拆分为一个微服务。
- 服务独立部署：
    每个微服务都严格遵循独立打包部署的原则，互不影响。
- 服务独立维护：
    每个微服务都可以交由一个小团队甚至个人来开发、测试、发布和运维，并对整个生命周期负责。
- 服务治理能力要求高：
    因为拆分为微服务之后，服务的数量变多，所以要有统一的服务治理平台来对各个服务进行管理。

## 总结

微服务架构是将复杂臃肿的单体应用进行细粒度的服务化拆分，每个拆分出来的服务各自独立打包部署，并交由小团队进行开发和运维，从而极大提高了应用的交付周期。